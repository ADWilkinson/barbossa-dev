# Barbossa

> AI engineers that ship code while you sleep.

Barbossa runs AI agents on a schedule to find issues, implement fixes, create PRs, and review code. You wake up to merged PRs.

## Modes

| Mode | Description |
|------|-------------|
| **Autonomous** (default) | Agents implement, review, and merge code |
| **Spec Mode** | Generates cross-repo feature specs, no code changes |

## Agents

| Agent | Role | Frequency |
|-------|------|-----------|
| Engineer | Implements issues from backlog | 12x daily |
| Tech Lead | Reviews PRs, merges or requests changes | 12x daily |
| Discovery | Finds TODOs, missing tests, tech debt | 6x daily |
| Product | Suggests high-value features | 3x daily |
| Auditor | Weekly health check | Daily |
| Spec Generator | Cross-repo feature specs (Spec Mode only) | Configurable |

## Pipeline

```
Discovery + Product → GitHub Issues (backlog) → Engineer → PR → Tech Lead → Merge
```

## Requirements

- Docker
- GitHub token (`gh auth token`)
- Claude token (`claude setup-token`) or Anthropic API key

## Install

```bash
curl -fsSL https://raw.githubusercontent.com/ADWilkinson/barbossa-dev/main/install.sh | bash
cd barbossa && docker compose up -d
docker exec barbossa barbossa health
```

## Configuration

File: `config/repositories.json`

### Minimal

```json
{
  "owner": "username",
  "repositories": [
    { "name": "my-app", "url": "https://github.com/username/my-app.git" }
  ]
}
```

### Full

```json
{
  "owner": "username",
  "repositories": [
    {
      "name": "my-app",
      "url": "https://github.com/username/my-app.git",
      "package_manager": "pnpm",
      "do_not_touch": ["src/auth/**", "prisma/migrations/"],
      "focus": "Bug fixes only, no new features"
    }
  ],
  "settings": {
    "tech_lead": {
      "auto_merge": true,
      "min_lines_for_tests": 50
    },
    "schedule": {
      "engineer": "every_2_hours",
      "tech_lead": "every_2_hours",
      "discovery": "4x_daily",
      "product_manager": "2x_daily"
    },
    "notifications": {
      "enabled": true,
      "discord_webhook": "https://discord.com/api/webhooks/..."
    }
  }
}
```

### Schedule presets

```
every_hour, every_2_hours, every_3_hours, every_4_hours, every_6_hours
4x_daily, 3x_daily, 2x_daily
daily_morning, daily_evening
disabled
```

Or cron: `"0 9,17 * * *"`

### Disable agents

```json
{ "settings": { "discovery": { "enabled": false } } }
```

Or: `"discovery": "disabled"` in schedule.

### Spec Mode

```json
{
  "products": [
    {
      "name": "my-platform",
      "repositories": ["backend", "frontend"],
      "primary_repo": "frontend",
      "context": {
        "vision": "Leading platform for X",
        "constraints": ["API < 200ms"]
      }
    }
  ],
  "settings": {
    "spec_mode": { "enabled": true }
  }
}
```

## Commands

```bash
docker exec barbossa barbossa health         # Status
docker exec barbossa barbossa run engineer   # Run agent
docker exec barbossa barbossa run tech-lead
docker exec barbossa barbossa run discovery
docker exec barbossa barbossa run product
docker exec barbossa barbossa run auditor
docker exec barbossa barbossa run spec       # Spec Mode only
docker exec barbossa barbossa status         # Activity
docker exec barbossa barbossa logs engineer  # Logs
docker compose stop                          # Pause
docker compose start                         # Resume
```

## Security

- Container runs as non-root (`barbossa`, UID 1000)
- Branch prefix: `barbossa/`
- One PR at a time per repo
- No force push
- No access to other repos
- Protected files via `do_not_touch`

## Tech Lead Review

8 dimensions: code quality, tests, security, performance, complexity, UI/UX, integration, bloat.

3-strikes rule: PR closes after 3 failed reviews.

## Notifications

Discord webhooks:

```json
{
  "settings": {
    "notifications": {
      "enabled": true,
      "discord_webhook": "https://discord.com/api/webhooks/...",
      "notify_on": {
        "pr_created": true,
        "pr_merged": true,
        "pr_closed": false,
        "error": true
      }
    }
  }
}
```

## Telemetry

Anonymous (run counts, success rates). No code or repo names.

Opt out: `"settings": { "telemetry": false }`

Or: `export BARBOSSA_ANALYTICS_OPT_OUT=true`

## Links

- Docs: https://barbossa.dev
- GitHub: https://github.com/ADWilkinson/barbossa-dev
- Issues: https://github.com/ADWilkinson/barbossa-dev/issues
